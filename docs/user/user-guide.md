# BTC Watcher 用户手册

## 📖 概述

本手册详细介绍BTC Watcher系统的各项功能和使用方法，帮助用户充分利用系统的监控、管理和分析能力。

## 🎯 核心功能

### 1. 策略管理
- **策略生命周期管理**: 创建、配置、启动、停止、删除
- **批量操作**: 支持批量启动/停止策略
- **策略模板**: 预设策略配置模板
- **版本控制**: 策略配置文件版本管理

### 2. 信号监控
- **实时信号接收**: 支持999个并发策略信号
- **信号分级**: 自动强度分析（强/中/弱/忽略）
- **信号历史**: 完整的信号接收历史记录
- **信号统计**: 多维度信号分析报表

### 3. 系统监控
- **资源监控**: CPU、内存、磁盘使用率
- **容量监控**: 策略容量使用情况
- **性能监控**: API响应时间、数据库性能
- **告警通知**: 多渠道实时告警

### 4. 通知管理
- **多渠道支持**: Telegram、企业微信、飞书、邮件
- **智能分级**: 根据信号强度选择通知方式
- **通知历史**: 完整的通知发送记录
- **免打扰**: 支持时间段免打扰设置

## 🖥️ 界面导览

### 登录界面
- 用户登录/注册
- 密码找回
- 系统信息展示

### 主仪表盘
```
┌─────────────────────────────────────────────────────────────┐
│  BTC Watcher 仪表盘                                        │
├─────────────────────────────────────────────────────────────┤
│  [策略总数: 15] [信号总数: 1,234] [容量使用: 15%]        │
├─────────────────────────────────────────────────────────────┤
│  容量趋势图表        │  信号分布饼图                    │
│  📈━━━━━━━━━━        │  🔴强: 45% 🔵中: 30% 🟢弱: 25%  │
├─────────────────────────────────────────────────────────────┤
│  运行中策略列表                                             │
│  ┌─────┬──────────┬────────┬──────┬────────┬─────────────┐ │
│  │ ID  │ 名称     │ 交易对 │ 状态 │ 运行时长 │ 今日信号   │ │
│  ├─────┼──────────┼────────┼──────┼────────┼─────────────┤ │
│  │ 1   │ BTC策略  │ BTC/USDT│ 运行 │ 2天     │ 12         │ │
│  │ 2   │ ETH策略  │ ETH/USDT│ 运行 │ 1天     │ 8          │ │
│  └─────┴──────────┴────────┴──────┴────────┴─────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### 策略管理页面
```
┌─────────────────────────────────────────────────────────────┐
│  策略管理                                                   │
├─────────────────────────────────────────────────────────────┤
│  [搜索策略...] [+创建策略] [批量操作▼] [刷新]              │
├─────────────────────────────────────────────────────────────┤
│  ┌─────┬──────────┬────────┬──────┬────────┬─────────────┐ │
│  │ ID  │ 名称     │ 类别   │ 状态 │ 端口   │ 操作        │ │
│  ├─────┼──────────┼────────┼──────┼────────┼─────────────┤ │
│  │ 1   │ 趋势策略 │ MACD   │ 🟢运行│ 8081   │ [停止][编辑]│ │
│  │ 2   │ 震荡策略 │ RSI    │ 🔴停止│ 8082   │ [启动][编辑]│ │
│  │ 3   │ 突破策略 │ BOLL   │ 🟡错误│ 8083   │ [重启][编辑]│ │
│  └─────┴──────────┴────────┴──────┴────────┴─────────────┘ │
├─────────────────────────────────────────────────────────────┤
│  [◀上一页] 页码: 1/5 [下一页▶] 每页: 10条                  │
└─────────────────────────────────────────────────────────────┘
```

### 信号监控页面
```
┌─────────────────────────────────────────────────────────────┐
│  信号监控                                                   │
├─────────────────────────────────────────────────────────────┤
│  筛选条件: [交易对▼] [动作▼] [强度▼] [时间范围▼] [应用]    │
├─────────────────────────────────────────────────────────────┤
│  ┌──────────┬──────┬────────┬───────┬──────┬──────────────┐ │
│  │ 时间     │交易对│ 动作   │ 强度  │ 价格 │ 策略         │ │
│  ├──────────┼──────┼────────┼───────┼──────┼──────────────┤ │
│  │ 14:32:15 │BTC/USDT│ 买入  │ 🔴强  │43250│ 趋势策略     │ │
│  │ 14:28:42 │ETH/USDT│ 卖出  │ 🔵中  │2680 │ 震荡策略     │ │
│  │ 14:25:33 │BNB/USDT│ 买入  │ 🟢弱  │ 312 │ 突破策略     │ │
│  └──────────┴──────┴────────┴───────┴──────┴──────────────┘ │
├─────────────────────────────────────────────────────────────┤
│  实时更新: 🟢开启 [暂停更新] [手动刷新] [导出数据]        │
└─────────────────────────────────────────────────────────────┘
```

## 🔧 功能详解

### 策略管理

#### 创建策略
1. 点击"创建策略"按钮
2. 填写策略基本信息：
   - **策略名称**: 唯一标识符
   - **策略类别**: 选择预设策略模板
   - **交易对**: 如BTC/USDT, ETH/USDT
   - **时间框架**: 1m, 5m, 15m, 1h, 4h, 1d
3. 配置策略参数：
   - **初始资金**: 策略起始资金
   - **单次交易量**: 每次交易的资金量
   - **最大持仓数**: 同时持有的最大仓位数
   - **止损比例**: 止损触发百分比
   - **止盈比例**: 止盈触发百分比
4. 设置信号阈值：
   - **强信号阈值**: ≥0.8
   - **中等信号阈值**: ≥0.6
   - **弱信号阈值**: ≥0.4
5. 点击"保存"完成创建

#### 策略配置示例
```json
{
  "name": "BTC趋势策略",
  "strategy_class": "TrendStrategy",
  "exchange": "binance",
  "timeframe": "1h",
  "stake_amount": 100,
  "max_open_trades": 3,
  "stoploss": -0.05,
  "take_profit": 0.08,
  "signal_thresholds": {
    "strong": 0.8,
    "medium": 0.6,
    "weak": 0.4
  },
  "indicators": {
    "macd": {
      "fast_period": 12,
      "slow_period": 26,
      "signal_period": 9
    },
    "rsi": {
      "period": 14,
      "overbought": 70,
      "oversold": 30
    }
  }
}
```

#### 策略状态管理
- **🟢运行**: 策略正常运行，接收市场数据
- **🔴停止**: 策略已停止，不接收数据
- **🟡错误**: 策略运行出错，需要检查
- **🟠启动中**: 策略正在启动过程中
- **🔵停止中**: 策略正在停止过程中

### 信号监控

#### 信号分级系统
```
信号强度计算：
┌─────────────────────────────────────────────────────────────┐
│  技术指标评分(40%) + 市场环境评分(30%) + 风险控制评分(30%)   │
└─────────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────────┐
│  综合评分: 0.0 - 1.0                                      │
└─────────────────────────────────────────────────────────────┘
                          ↓
    ┌──────────┬──────────┬──────────┬──────────┬──────────┐
    │   忽略   │   弱信号  │   中等   │   强信号  │  强烈推荐 │
    │ (<0.4)   │ (0.4-0.6)│ (0.6-0.8)│ (0.8-0.9)│ (>0.9)   │
    └──────────┴──────────┴──────────┴──────────┴──────────┘
```

#### 信号详情
点击信号记录可查看详细信息：
- **基本信息**: 时间、交易对、动作、价格
- **信号强度**: 综合评分、各项指标得分
- **技术指标**: MACD、RSI、布林带等数值
- **市场环境**: 波动率、成交量、趋势强度
- **风险评估**: 最大回撤、夏普比率、胜率预测

#### 信号统计
- **日统计**: 每日信号数量、强度分布
- **策略对比**: 不同策略的信号表现
- **时段分析**: 信号在时间上的分布规律
- **盈亏统计**: 信号对应的实际交易结果

### 系统监控

#### 资源监控
```
实时监控指标：
┌─────────────────────────────────────────────────────────────┐
│  CPU使用率: 45%                    ████▌45%                │
│  内存使用率: 62%                    ██████▌62%              │
│  磁盘使用率: 38%                    ███▌38%                 │
│  网络I/O: 12MB/s ↓ / 5MB/s ↑                                │
└─────────────────────────────────────────────────────────────┘
```

#### 容量监控
- **总容量**: 999个策略槽位
- **已使用**: 当前运行的策略数量
- **可用容量**: 剩余可启动的策略数量
- **容量趋势**: 历史容量使用曲线
- **预测告警**: 容量即将满载的预警

#### 性能监控
- **API响应时间**: 各接口的平均响应时间
- **数据库性能**: 查询耗时、连接数、慢查询
- **缓存命中率**: Redis缓存的效果
- **错误率**: 系统错误的发生频率

### 通知管理

#### 通知渠道配置
1. **Telegram Bot**
   - 创建Bot: 通过@BotFather
   - 获取Chat ID: 向@userinfobot发送消息
   - 测试连接: 发送测试消息

2. **企业微信**
   - 创建群聊机器人
   - 获取Webhook URL
   - 配置安全密钥

3. **飞书**
   - 创建自定义机器人
   - 获取Webhook地址
   - 配置签名验证

4. **邮件通知**
   - SMTP服务器配置
   - 发件人邮箱设置
   - 收件人列表管理

#### 通知分级策略
```
通知优先级：
┌─────────────────────────────────────────────────────────────┐
│  P0 (紧急)    │ 系统故障、安全告警、重大错误            │
│               │ 通知方式: 所有渠道 + 短信               │
├───────────────┼─────────────────────────────────────────┤
│  P1 (重要)    │ 强信号、策略异常、容量告警              │
│               │ 通知方式: Telegram + 邮件               │
├───────────────┼─────────────────────────────────────────┤
│  P2 (普通)    │ 中等信号、日常报告                      │
│               │ 通知方式: Telegram                      │
├───────────────┼─────────────────────────────────────────┤
│  P3 (低)      │ 弱信号、统计报告                        │
│               │ 通知方式: 应用内通知                    │
└───────────────┴─────────────────────────────────────────────┘
```

#### 免打扰设置
- **时间段设置**: 设置不接收通知的时间段
- **策略过滤**: 指定某些策略不发送通知
- **强度过滤**: 只接收指定强度以上的信号
- **频率限制**: 限制同一策略的通知频率

## 📊 数据分析

### 策略表现分析

#### 关键指标
- **总收益率**: 策略总体收益情况
- **胜率**: 盈利交易占总交易的比例
- **平均盈亏比**: 平均盈利与平均亏损的比值
- **最大回撤**: 历史最大资金回撤幅度
- **夏普比率**: 风险调整后的收益率

#### 图表分析
1. **收益曲线**: 策略收益的时间序列图
2. **交易分布**: 交易时间、频率的分布图
3. **盈亏分析**: 盈利和亏损交易的对比图
4. **风险指标**: 各种风险指标的趋势图

### 信号效果分析

#### 信号质量评估
```
信号质量评分：
┌─────────────────────────────────────────────────────────────┐
│  准确率(30%) + 收益率(40%) + 稳定性(30%) = 综合评分        │
└─────────────────────────────────────────────────────────────┘
```

#### 回测分析
- **历史回测**: 基于历史数据的策略表现
- **实盘对比**: 回测结果与实际表现的对比
- **参数优化**: 寻找最优的策略参数组合
- **过拟合检测**: 避免过度优化导致的过拟合

## ⚙️ 系统设置

### 用户设置
- **个人信息**: 用户名、邮箱、密码修改
- **界面偏好**: 主题、语言、时区设置
- **通知偏好**: 通知渠道、频率、过滤规则
- **安全设置**: 两步验证、登录历史

### 系统配置
- **基础配置**: 系统名称、Logo、联系信息
- **性能配置**: 缓存策略、并发限制、超时设置
- **安全配置**: 访问控制、IP白名单、安全策略
- **备份配置**: 自动备份、保留策略、恢复设置

### 高级设置
- **API配置**: 速率限制、访问令牌、WebHook设置
- **数据源配置**: 交易所API、数据供应商、更新频率
- **自定义指标**: 创建自定义技术指标和评分规则
- **自动化规则**: 设置自动化的策略管理规则

## 🔍 高级功能

### API接口使用

#### 认证方式
```bash
# 获取访问令牌
curl -X POST "http://localhost:8000/api/v1/auth/token" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=your_username&password=your_password"

# 使用令牌访问API
curl -X GET "http://localhost:8000/api/v1/strategies/" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

#### 常用API端点
```
# 策略管理
GET    /api/v1/strategies/          # 获取策略列表
POST   /api/v1/strategies/          # 创建策略
GET    /api/v1/strategies/{id}      # 获取策略详情
PUT    /api/v1/strategies/{id}      # 更新策略
DELETE /api/v1/strategies/{id}      # 删除策略
POST   /api/v1/strategies/{id}/start # 启动策略
POST   /api/v1/strategies/{id}/stop  # 停止策略

# 信号管理
GET    /api/v1/signals/             # 获取信号列表
GET    /api/v1/signals/{id}         # 获取信号详情
GET    /api/v1/signals/stats        # 获取信号统计

# 系统管理
GET    /api/v1/system/health         # 健康检查
GET    /api/v1/system/capacity       # 系统容量
GET    /api/v1/system/metrics        # 系统指标
```

### WebSocket实时数据

#### 连接方式
```javascript
// JavaScript示例
const ws = new WebSocket('ws://localhost:8000/ws');

ws.onopen = function(event) {
    console.log('WebSocket连接已建立');
    
    // 订阅系统监控
    ws.send(JSON.stringify({
        type: 'subscribe',
        channel: 'system'
    }));
    
    // 订阅策略更新
    ws.send(JSON.stringify({
        type: 'subscribe',
        channel: 'strategies'
    }));
};

ws.onmessage = function(event) {
    const data = JSON.parse(event.data);
    console.log('收到实时数据:', data);
    
    // 处理不同类型的数据
    switch(data.type) {
        case 'system_metrics':
            updateSystemMetrics(data.payload);
            break;
        case 'strategy_update':
            updateStrategyStatus(data.payload);
            break;
        case 'signal_received':
            handleNewSignal(data.payload);
            break;
    }
};
```

#### 支持的数据类型
- **系统指标**: CPU、内存、磁盘实时数据
- **策略状态**: 策略启动、停止、错误状态
- **信号推送**: 新信号实时推送
- **容量更新**: 系统容量变化通知
- **告警信息**: 系统告警实时推送

## 🛡️ 安全与合规

### 访问控制
- **用户认证**: JWT令牌认证机制
- **权限管理**: 基于角色的访问控制
- **会话管理**: 安全的会话生命周期管理
- **审计日志**: 完整的操作审计记录

### 数据安全
- **数据加密**: 敏感数据加密存储
- **传输加密**: HTTPS/TLS传输加密
- **备份加密**: 备份数据加密保护
- **密钥管理**: 安全的密钥存储和管理

### 合规要求
- **数据保护**: 符合GDPR等数据保护法规
- **隐私保护**: 用户隐私数据保护
- **审计要求**: 满足金融审计要求
- **监管报告**: 支持监管机构报告需求

---

**📚 相关文档**:
- [快速开始](getting-started.md) - 5分钟上手
- [部署指南](deployment-guide.md) - 完整部署流程
- [API参考](api-reference.md) - API接口文档
- [故障排查](troubleshooting.md) - 常见问题解决
- [FAQ](faq.md) - 常见问题答疑

---

**📞 技术支持**:
- 📧 Email: support@btc-watcher.com
- 💬 在线客服: 工作日 9:00-18:00
- 📖 文档中心: https://docs.btc-watcher.com
- 🐛 问题反馈: https://github.com/yourusername/btc-watcher/issues