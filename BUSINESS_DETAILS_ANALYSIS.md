# BTC Watcher 业务细节明确

## 需要进一步明确的业务细节问题

### 1. FreqTrade策略配置细节

#### 1.1 图形化配置参数范围
**问题**：哪些FreqTrade策略参数值得图形化配置？哪些应该保留代码编辑？

**分析和建议**：

**P0 - 必须图形化的参数**：
- **基础配置**：
  - 策略名称和描述
  - 启用/禁用状态
  - 时间周期 (1m, 5m, 15m, 1h, 4h, 1d)
  - 监控的交易对列表

- **风险控制参数**：
  - 止损百分比 (stoploss)
  - 最大持仓时间 (max_open_trades)
  - 最小ROI设置
  - 资金管理比例

- **常用技术指标参数**：
  - MA均线周期 (fast_period, slow_period)
  - RSI参数 (rsi_period, rsi_buy_threshold, rsi_sell_threshold)
  - MACD参数 (macd_fast, macd_slow, macd_signal)
  - 布林带参数 (bb_period, bb_std_dev)

**P1 - 可选图形化的参数**：
- **高级风险控制**：
  - 动态止损设置
  - 分批入场/出场设置
  - 回撤保护参数

- **交易所配置**：
  - 手续费设置
  - 滑点容忍度
  - 最小交易金额

**保留代码编辑的部分**：
- 复杂的条件逻辑组合
- 自定义技术指标计算
- 特殊的信号过滤逻辑
- 高级的仓位管理算法

#### 1.2 策略模板设计
**问题**：应该提供哪些预设的策略模板？

**建议的模板**：
1. **MA交叉策略** - 双均线金叉死叉
2. **RSI超买超卖策略** - RSI指标买卖点
3. **MACD策略** - MACD柱状图和信号线
4. **布林带策略** - 布林带突破和回归
5. **组合指标策略** - 多指标确认模式
6. **自定义策略** - 空白模板，完全自定义

### 2. 信号展示和管理细节

#### 2.1 信号分类和优先级
**问题**：如何对交易信号进行分类和优先级排序？

**信号类型分类**：
- **强度等级**：
  - 强烈信号 (85-100%置信度) - 红色/绿色高亮
  - 中等信号 (60-84%置信度) - 橙色/浅绿
  - 弱信号 (40-59%置信度) - 黄色/灰色
  - 参考信号 (<40%置信度) - 浅色显示

- **信号类型**：
  - 买入信号 (BUY)
  - 卖出信号 (SELL)
  - 止损信号 (STOP_LOSS)
  - 持有信号 (HOLD)

**显示优先级**：
1. 最新时间优先
2. 强度等级优先
3. 关注币种优先
4. 策略重要性优先

#### 2.2 信号历史管理
**问题**：信号历史如何存储和查询？

**存储策略**：
- **实时信号**：Redis缓存，保存最近24小时
- **历史信号**：PostgreSQL，按您的要求永久保存
- **信号统计**：按策略、按币种、按时间段统计成功率

**查询维度**：
- 按时间范围查询
- 按策略筛选
- 按币种筛选
- 按信号强度筛选
- 按盈亏结果筛选

### 3. 代理管理业务细节

#### 3.1 代理测试标准
**问题**：如何定义代理"可用"的标准？

**测试指标**：
- **连接成功率** > 90% (最近100次测试)
- **平均延迟** < 500ms
- **数据获取成功率** > 95%
- **连续失败次数** < 3次

**测试方法**：
1. **连通性测试**：ping目标交易所
2. **API测试**：实际调用交易所API获取数据
3. **速度测试**：测量数据下载时间
4. **稳定性测试**：连续多次请求的成功率

#### 3.2 故障切换逻辑
**问题**：代理失效时的具体处理流程？

**故障判断**：
- 连续3次请求失败
- 延迟超过5秒
- 返回错误状态码

**切换流程**：
1. 标记当前代理为"故障"状态
2. 尝试直连模式
3. 如果直连失败，发送高优先级通知
4. 每10分钟重新测试故障代理
5. 恢复后自动切回代理模式

### 4. 通知系统业务细节

#### 4.1 通知内容模板
**问题**：不同类型通知应该包含哪些具体信息？

**交易信号通知模板**：
```
🔔 交易信号
币种: BTC/USDT
信号: 买入 (强度: 85%)
价格: $42,500
策略: MA_Cross_v2.1
时间: 2024-01-15 14:25:30
指标: RSI:68.5 MACD:+0.25
[查看图表]
```

**系统告警通知模板**：
```
⚠️ 系统告警
类型: 代理连接失败
详情: SOCKS5代理超时
影响: 数据获取中断
时间: 2024-01-15 14:25:30
建议: 检查网络连接
[查看详情]
```

#### 4.2 通知频率控制
**问题**：如何避免通知轰炸？

**控制策略**：
- **相同币种限制**：5分钟内同一币种最多1条信号通知
- **紧急程度分级**：
  - P0（立即）：系统故障、强烈信号
  - P1（1分钟内）：中等信号、策略状态变化
  - P2（5分钟内）：弱信号、定期报告
- **时间段控制**：您要求的自定义时间段配置
- **批量汇总**：低优先级通知可以批量发送

### 5. 策略状态监控细节

#### 5.1 策略健康状态判断
**问题**：如何判断策略是否正常运行？

**健康指标**：
- **进程状态**：FreqTrade进程是否存活
- **数据更新**：最后数据更新时间 < 1分钟
- **信号产生**：最近24小时是否有信号输出
- **错误频率**：错误日志数量是否异常
- **内存使用**：是否有内存泄漏

**状态分类**：
- **运行中** ●绿色：所有指标正常
- **警告** ⚠️黄色：部分指标异常但可运行
- **错误** ❌红色：关键指标异常，需要干预
- **停止** ○灰色：手动停止或未启动

#### 5.2 策略性能统计
**问题**：策略运行效果如何评估？

**统计指标**：
- **信号数量**：总信号数、买入/卖出信号分布
- **信号质量**：如果有回测数据，显示胜率
- **运行时长**：连续运行时间
- **错误率**：错误次数/总运行时间
- **资源使用**：CPU和内存占用

### 6. 多语言支持细节

#### 6.1 语言切换范围
**问题**：哪些内容需要多语言支持？

**必须支持的内容**：
- 所有UI界面文本
- 按钮、菜单、表头
- 提示信息和错误消息
- 表单标签和验证信息

**可选支持的内容**：
- 通知消息内容
- 日志输出内容
- 帮助文档

**不需要翻译的内容**：
- 策略名称（用户自定义）
- 币种代码（BTC/USDT等）
- 技术指标数值
- 日期时间（使用本地化格式）

#### 6.2 语言偏好设置
**问题**：语言设置如何保存和应用？

**保存机制**：
- 登录前：浏览器localStorage
- 登录后：用户配置数据库
- 通知语言：跟随界面语言或独立设置

### 7. 用户管理细节

#### 7.1 用户权限范围
**问题**：个人使用系统需要哪些权限控制？

**基础权限设计**：
由于是个人使用，权限可以简化：
- **登录用户**：拥有所有功能权限
- **会话管理**：支持单点登录，其他地方登录会踢掉当前会话
- **操作日志**：记录关键操作（策略启停、配置修改）

#### 7.2 安全考虑
**问题**：个人系统的安全要求？

**安全措施**：
- **密码复杂度**：最低要求（长度、字符类型）
- **登录保护**：连续失败5次锁定30分钟
- **会话超时**：24小时自动过期
- **操作确认**：删除策略、清空数据等需要确认

---

## 待进一步明确的问题

1. **FreqTrade配置文件格式**：我们需要研究FreqTrade的具体配置文件结构
2. **数据同步频率**：实时数据多久更新一次？历史数据如何管理？
3. **图表技术指标**：TradingView风格图表需要支持哪些具体指标？
4. **备份恢复策略**：您要求的自动备份具体包含哪些数据？
5. **系统监控指标**：除了CPU/内存，还需要监控哪些系统指标？

请您审查这些业务细节分析，特别是FreqTrade策略配置部分，看是否符合您的实际使用需求。